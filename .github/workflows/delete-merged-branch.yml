name: Delete Merged Branch
on:
    pull_request:
        types: [closed]
jobs:
    delete-branch:
        if: github.event.pull_request.merged == true
        runs-on: ubuntu-latest
        steps:
            - name: Delete branch
              uses: actions/github-script@v7
              with:
                  script: |
                      const { owner, repo } = context.repo;
                      const branch = context.payload.pull_request.head.ref;
                      try {
                        await github.rest.git.deleteRef({
                          owner,
                          repo,
                          ref: `heads/${branch}`,
                        });
                        console.log(`Deleted branch: ${branch}`);
                      } catch (error) {
                        console.log(`Branch not deleted (may be from a fork or already deleted): ${error.message}`);
                      }
